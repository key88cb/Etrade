# 数据模块开发指南

## Python

### 版本

Python 版本 3.12

### 缩进和换行

缩进是四个空格，换行理论上是有些东西之间必须换行，比如两个函数的定义之间，不过都不用在意，这里也用格式化工具统一

安装`black`

```bash
pip install black
```

使用

```bash
block .
```

### 命名规范

Python 中的变量是`snake_case`，类名是`CamelCase`

### 函数规范

**不使用**类型提示，类型提示感觉是徒增麻烦，但对于**重要或复杂的函数**要写文档注释，用中文，如下所示

```py
def f():
    """
    描述：这是一个XXX的函数
    参数：...
    返回值：...
    """
    pass
```

### 导入规范

不需要特意关注，这个使用`isort`工具保证

下载`isort`工具

```bash
pip install isort
```

格式化当前目录的全部导入

```bash
isort .
```

### 库配置文件

这个不需要手动输入，可以使用`pipreqs`自动生成`requirements.txt`，如果需要覆盖则添加`--force`参数

安装`pipreqs`

```bash
pip install pipreqs
```

```bash
# 指定输出为兼容模式
pipreqs . --force --mode compat
```

### 其它注意事项

1. 在 vscode 和 cursor 之类的编辑器里面，通过插件运行`python`会默认运行路径是在当前打开的文件夹下，比如我打开整个Etrade项目，然后F5运行`etrade/data`目录下的Python代码，代码是跑在`etrade/`目录下的，这个主要会引发一些相对路径的问题。
2. `analyse.py` 支持通过命令行参数限定分析时间段，例如：
   ```bash
   python analyse.py --start 2025-09-01T00:00:00Z --end 2025-09-07T23:59:59Z
   ```
   如果不指定 `--start/--end`，默认分析全量数据。
